version: '3.5'

networks:
    backend-network:
        external:
            name: '${BACKEND_NETWORK_NAME}'

services:
    # Nextjs applicaton container
    &app-service node: &app-service-template
        image: node:16-alpine
        logging:
            driver: 'json-file'
            options:
                max-file: '2'
                max-size: '5m'
        environment: &app-service-envs
            CLIENT_API_URL: '${CLIENT_API_URL}'
            SSR_API_URL: '${SSR_API_URL}'
            HOST_URL: '${HOST_URL}'
        working_dir: '/app'
        volumes:
            - ./../../src:/app:rw
        networks:
            - backend-network
